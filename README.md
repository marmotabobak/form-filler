# Form Auto Fill

Расширение для Chrome, которое автоматически заполняет поля формы Ozon (ozon, o3) данными пользователя:
- **ФИО**
- **E-mail**
- **Fan ID**
- **чекбокс согласия на обработку ПД**

# Quick start

## Установка
1. Склонируйте или скачайте репозиторий.
2. Откройте `chrome://extensions/` в браузере Chrome.
3. Включите «Режим разработчика».
4. Нажмите «Загрузить распакованное» и выберите папку проекта.
5. Расширение появится в списке.

## Использование
1. Кликните на иконку расширения и заполните настройки — значения сохраняются автоматически по мере ввода.
2. Откройте форму Ozon.
3. Включите тумблер «Включить автозаполнение» в попапе (по умолчанию выключен).
4. Расширение заполнит только те поля, которые вы задали в попапе.
Заполненные настройки сохраняются и не требуют повторного заполнения при перезапуске браузера.

# Описание проекта

## Возможности
- Автозаполнение заданных полей формы при открытии страницы (на доменах из `manifest.json` → `content_scripts.matches`).
- Поддержка динамических форм через `MutationObserver` с дебаунсом.
- Раннее завершение: скрипт останавливается, когда заполнены все поля, заданные пользователем в попапе (незаполненные поля игнорируются).
- Ограничения безопасности: максимум попыток и общий таймаут работы скрипта.
- Централизованное логирование в консоли контекста и в консоли фонового service worker.
- Сохранение настроек в браузере (`chrome.storage.sync`) при их изменении.

## Структура проекта
| Файл                               | Назначение                                   |
|------------------------------------|----------------------------------------------|
| `manifest.json`                    | Конфигурация расширения (MV3)                |
| `background/service-worker.js`     | Фоновая логика, обработка событий, логи       |
| `content/init.js`                  | Точка входа контент‑скрипта (чтение настроек) |
| `content/form-observer.js`         | Запуск/остановка `MutationObserver`, ретраи   |
| `content/autofill.js`              | Поиск полей и фактическое заполнение          |
| `popup/index.html`                 | Разметка попапа                               |
| `popup/popup.css`                  | Стили попапа                                  |
| `popup/popup.js`                   | Точка входа попапа                            |
| `popup/ui.js`                      | Работа с DOM попапа                           |
| `popup/storage.js`                 | Чтение/запись `chrome.storage.sync`           |
| `shared/field-config.js`           | Ключевые слова/исключения для поиска полей    |
| `shared/utils.js`                  | Вспомогательные функции                       |
| `shared/logger.js`                 | Унифицированный логгер                        |

## Поведение автозаполнения
- Поиск полей: эвристики на основе ближайших `label/placeholder/name/title/aria-label`.
- Если поле уже содержит верное значение, считается успехом, повторная установка не выполняется и предупреждения не печатаются.
- При истечении таймаута выполняется финальная попытка с принудительным логированием пропусков.

## Логирование и отладка
- Используйте `Logger.info/success/warn/error` — логи выводятся в консоль текущего контекста и пересылаются в фон (`service-worker`).
- Консоль фонового воркера: `chrome://extensions` → режим разработчика → ваше расширение → `Service worker` → `Inspect`.
- Типичные события фона: `onInstalled`, `onStartup`, входящие `runtime.onMessage`.

## Дальнейшие планы
- [ ] Юнит‑тесты (Jest + JSDOM).
- [ ] Вынести конфигурацию ключевых слов в настройки попапа.
- [ ] Просмотр логов работы через попап.
- [ ] ESLint + Prettier.
- [ ] GitHub Actions для CI.